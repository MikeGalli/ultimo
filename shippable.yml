language: node_js

node_js: 
    - 0.12

# build image
build_image: shippableimages/ubuntu1404_nodejs

env: 
  global:
    - PROJECT=KariGran HIPCHAT_ROOM=KariGran
    - secure: 8b95e19a-1a63-49b0-a03e-ae4fedce4be7

before_install:
    # install NodeJS v0.12
    - source ~/.nvm/nvm.sh && nvm install $SHIPPABLE_NODE_VERSION
    - npm update -g npm 
    - npm version
    - npm install -g gulp bower

install: 
    # install the required dependencies
    - npm install
    - bower install

script: 
    - NODE_ENV=production gulp build

after_failure:
    - python hipchat_notifier_v2.py --project $PROJECT --room $HIPCHAT_ROOM --token $HIPCHAT_TOKEN

after_success:
    - python hipchat_notifier_v2.py --project $PROJECT --room $HIPCHAT_ROOM --token $HIPCHAT_TOKEN -s
