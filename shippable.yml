language: node_js

node_js: 
    - 0.12

# build image
build_image: shippableimages/ubuntu1404_nodejs

env: 
  global:
    - PROJECT=KariGran HIPCHAT_ROOM=KariGran
    - secure: Z1cpkgfxpFoLbu6K5VG/ADqTqAMCGbqKFx8GopC7CaRBbokbc9TZ5+Ww+RRO2yS8EXshOLcukdmDVlY8HW2JA26/xmFWhr46jqzwYYPJBQ4ZUv7FAqt9TJh0hhvvX6Fzwl/P9kWq5s8ZcqTq1z383P3M0mSTKr7H80AlfLspdi4nEMnwyzU2LipfmyGPbZliuGj1DII9u5YdZig+UFVb737Hk1CGJkp3bTTC1PNy9bkVg5P0yD1ExE8DmzCBHrTB5KtuI5X+y0+ITgZ9tQAAr52oqFJfkkr7Vr3AuiX4pk1Nt8BrurEGnYsHWJ4myNJ3IKb7l+YtiehLxvygtJ2ftw==

before_install:
    # install NodeJS v0.12
    - source ~/.nvm/nvm.sh && nvm install $SHIPPABLE_NODE_VERSION
    - npm update -g npm 
    - npm version
    - npm install -g gulp bower

install: 
    # install the required dependencies
    - npm install
    - bower install

script: 
    - NODE_ENV=production gulp build

after_failure:
    - python hipchat_notifier_v2.py --project $PROJECT --room $HIPCHAT_ROOM --token $HIPCHAT_TOKEN

after_success:
    - python hipchat_notifier_v2.py --project $PROJECT --room $HIPCHAT_ROOM --token $HIPCHAT_TOKEN -s
